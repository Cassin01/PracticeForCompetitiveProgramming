\documentclass{jsarticle}
\usepackage[dvipdfmx]{graphicx}
\usepackage{listings,jlisting}
\usepackage{float}

\title{情報工学実験2 数理計画法 第二回}

\author{学生番号4617043 神保光洋}
\date{\today}
\begin{document}
\maketitle

\section{要旨}
  最尤推定を行う場合の応用のされ方に付いて学習・演習する。
\section{目的}
  統計モデルを用いた分析に欠かせない、パラメタの推定の方法について、
  その基本的な技術を取得する
  ことを目的とする。
\section{理論}
  \subsection{ベイズの定理}
    ベイズの定理は以下の式で与えられる。

    $$P(A | B) = \frac{P(A)}{P(B)}P(B | A)$$

    ここで、$P(A | B) $はBが起ったときに Aが起こる確率を表す条件付き確率である。
    ここで、Bが起こった時に$A$が起こる確率$P(A | B)$は$B$が起こっている事象の割合
    である。つまり以下のように表すことができる。

    $$P(A | B) = \frac{P(A, B)}{P(B)}$$

    また、これらの関係は$A, B$を入れ替えても同様に成立するため、以下を得る

    $$P(B | A) = \frac{P(A, B)}{P(A)}$$

    これらの２つより、ベイズの定理が導出される。
  \subsection{最尤推定}
    このベイズの定理を使用することで、ある確率変数の値から別の確率変数の値を
    推定することが可能である。

    ある大学の男女別学部別の在籍者数が表1のようであったとする。

    この時、「この大学に所属する女子学生の学部」を推定することを考える。この時、
    「女子学生のそれぞれの学部に所属している確率」が最も高い学部に所属していると考える
    ことが自然である。

    \begin{table}[htb]
      \begin{center}
        \caption{ある大学の学部別、男女別在籍者数}
        \begin{tabular}{|c|l|l|} \hline
          学部         & 男子学生数 & 女子学生数\\ \hline
          理学部第一部 & 2230       & 611       \\
          理学部第二部 & 1271       & 390       \\
          薬学部       & 492        & 547       \\
          工学部       & 1771       & 417       \\
          工学部第二部 & 701        & 148       \\
          理工学部     & 4289       & 870       \\
          基礎工学部   & 1028       & 372       \\
          経営学部     & 950        & 441       \\
          学部合計     & 12732      & 3796      \\ \hline
        \end{tabular}
      \end{center}
    \end{table}

    つまり、以下のような数式を考えることが自然である。

    \begin{eqnarray*}
      \hat{(\mbox{学部})} = &\arg \max& P(\mbox{学部} | 女子学生) \\
                            &学部&
    \end{eqnarray*}

    この考え方は、じご分布最大化(Maximum a Posteriori:MAP) 推定と呼ばれる。
    それぞれの学部に付いて計算を行うと以下のようになる。

    \begin{eqnarray*}
      P(\mbox{理学部第一} | \mbox{女子学生}) &=& \frac{611}{3796}, \\
      P(\mbox{理学部第二} | \mbox{女子学生}) &=& \frac{611}{3796}, \\
        \vdots                               &&  \vdots            \\
      P(\mbox{経営学部}   | \mbox{女子学生}) &=& \frac{441}{3796}
    \end{eqnarray*}


    また、式(1)はベイズの定理を用いると以下のようにもかける。

    \begin{eqnarray*}
      \hat{(\mbox{学部})} = &\arg \max& P(学部 | 女子学生) \\
                            &学部&                         \\
      \hat{(\mbox{学部})} = &\arg \max& \frac{P(学部)}{P(女子学生)}P(女子学生 | 学部) \\
                            &学部&
    \end{eqnarray*}

    これらをそれぞれの学部に付いて計算すると以下のようになる。

    \begin{eqnarray*}
      \frac{P(\mbox{理学部第一})}{P(女子学生)}P(\mbox{女子学生} | \mbox{理学部第一}) &=&
      \frac{\frac{2230 + 611}{12732 + 3796}}{\frac{3796}{12732 + 3796}} \times
      \frac{611}{2230 + 611} \\
      \frac{P(\mbox{理学部第二})}{P(女子学生)}P(\mbox{女子学生} | \mbox{理学部第二}) &=&
      \frac{\frac{1271 + 390}{12732 + 3796}}{\frac{3796}{12732 + 3796}} \times
      \frac{390}{1271 + 390} \\
      \vdots &   & \vdots \\
      \frac{P(\mbox{経営学部})}{P(女子学生)}P(\mbox{女子学生} | \mbox{経営学部}) &=&
      \frac{\frac{950 + 441}{12732 + 3796}}{\frac{3796}{12732 + 3796}} \times
      \frac{441}{950 + 441}
    \end{eqnarray*}

    これらの式は計算の結果が全く変わらないことがわかる。

    ここで上式をよく見れば、$P(\mbox{女子学生})$ は学部に関係のない定数
    となっているため、以下のように考えても推定される学部は変化しない。

    $$
    \frac{P(\mbox{学部})}{P(\mbox{女子学生})}P(\mbox{女子学生} | \mbox{学部}) \propto P(\mbox{学部})P(\mbox{女子学生} | \mbox{学部})
    $$

    であり、よって、

    \begin{eqnarray*}
    \hat{(\mbox{学部})} = &\arg \max& P(学部 | 女子学生) \\
                         &学部& \\
                       = &\arg \max& P(\mbox{学部})P(\mbox{女子学生} | \mbox{学部}) \\
                         &学部&
    \end{eqnarray*}

    このように、確率ではないが、確率に比例するスコア：尤度を用いて推定を行うこともできる。
    この尤度が最大のものを推定値として採用する推定法が最尤推定である。

    \section{課題１}

    \begin{table}[htb]
      \begin{center}
        \caption{ある大学の学部別、男女別在籍者数の推定結果}
        {\scriptsize
        \begin{tabular}{|c|c|c|c|c|c|} \hline
                &           &            & 頻度による推定&	ベイズの定理に変換 & 最優推定 \\
          学部        & 男子学生数 & 女子学生数 & $P(\mbox{学部} | \mbox{女子})$ & $\frac{P(\mbox{学生})}{P(\mbox{女子学生})}P(\mbox{女子学生} | \mbox{学部})$ & $P(\mbox{学部})P(\mbox{女子学生} | \mbox{学部})$ \\ \hline
    理学部第一部 & 2230	    & 611	       & 0.160	       & 0.160	& 0.036 \\
    理学部第二部 & 1271	    & 390	       & 0.102	       & 0.102	& 0.023 \\
    薬学部	     & 492	    & 547        & 0.14	         & 0.144  & 0.033 \\
    工学部	     & 1771     & 417        & 0.109         & 0.109  & 0.025 \\
    工学部第二部 & 701      & 148	       & 0.038	       & 0.038	& 0.008 \\
    理工学部	   & 4289     & 870	       & 0.229 	       & 0.229  & 0.052 \\
    基礎工学部   & 1028     & 372	       & 0.097	       & 0.097  & 0.022 \\
    経営学部	   & 950	    & 441	       & 0.116 	       & 0.116  & 0.026 \\
    学部合計	   & 12732    & 3796       & 1	           &  1	    & 0.229 \\ \hline
        \end{tabular}
        }
      \end{center}
    \end{table}

      \subsection{課題1-1}
        この大学にある女子学生がいた場合、その学部を推定せよ。またなぜそう考えるのか思考の過程も記述せよ。


        表2とより頻度による推定値が最も高いのは理学部第一部であるが、
        上記した理論より尤度が最も高いのは理学部であることより、
        大学にある女子学生がいた場合その学部は理学部であると推定できる。
      \subsection{課題1-2}
        この大学にある経営学部学生がいた場合、その性別を推定せよ。なたなぜそう考えられるのか思考の課程も記述せよ。

        表より

    \begin{eqnarray*}
      P(\mbox{男子学生} | \mbox{経営学部生}) &=& \frac{\frac{950}{12732 + 3796}}{\frac{12732}{12732 + 3796}} \\
                                             &=& 0.0746 \\
      P(\mbox{女子学生} | \mbox{経営学部生}) &=& \frac{\frac{441}{12732 + 3796}}{\frac{3796}{12732 + 3796}} \\
                                             &=& 0.116
    \end{eqnarray*}

      であるので女子学生であると推定される。


\section{まとめ}
  最尤推定を行う場合の応用のされ方に付いて学ぶことができた。

\section{参考文献}
\begin{thebibliography}{9}
  \bibitem{key1} 東京大学教養学部統計学教室 統計学入門 (基礎統計学Ⅰ)・東大出版会
\end{thebibliography}

\section{付録}

\end{document}
